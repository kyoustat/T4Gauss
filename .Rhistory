xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
library(T4Gauss)
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
library(T4Gauss)
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
library(T4Gauss)
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",norm(cov(xe)-mysig),sep=""))
image(cov(xc), main=paste("chol  with d=",norm(cov(xc)-mysig),sep=""))
image(cov(xx), main=paste("mvtn  with d=",norm(cov(xx)-mysig),sep=""))
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
# my personal test
myn = 500
myp = 5
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
library(microbenchmark)
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
myn = 5000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
plot(stamp)
myn = 5000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
myn = 50000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
graphics.off()
graphics.off()
plot(stamp)
library(T4Gauss)
# my personal test
library(mvtnorm)
library(microbenchmark)
myn = 50000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
graphics.off()
plot(stamp)
library(T4Gauss)
# my personal test
library(mvtnorm)
library(microbenchmark)
myn = 50000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp <- microbenchmark(
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
)
graphics.off()
plot(stamp)
help(rmvnorm)
library(T4Gauss)
help(mvnorm)
help(rmvnorm)
library(T4Gauss)
help(rmvnorm)
library(T4Gauss)
library(T4Gauss)
myn = 5000
myp = 10
mymu  = rnorm(myp)
A     = matrix(rnorm(10000*myp),ncol=myp)
mysig = cov(A)
xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen")
xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol")
xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
par(mfrow=c(2,2), pty="s")
image(mysig,   main="original")
image(cov(xe), main=paste("eigen with d=",round(norm(cov(xe)-mysig),4),sep=""))
image(cov(xc), main=paste("chol  with d=",round(norm(cov(xc)-mysig),4),sep=""))
image(cov(xx), main=paste("mvtn  with d=",round(norm(cov(xx)-mysig),4),sep=""))
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
library(microbenchmark)
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
library(T4Gauss)
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
library(T4Gauss)
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
graphics.off()
autoplot(stamp2)
# stamp <- microbenchmark(
#   xe = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="eigen"),
#   xc = T4Gauss::rmvnorm(myn, mean=mymu, sigma=mysig, method="chol"),
#   xx = mvtnorm::rmvnorm(myn, mean=mymu, sigma=mysig)
# )
# graphics.off()
# plot(stamp)
#
#
# test : dmvnorm ----------------------------------------------------------
library(ggplot2)
autoplot(stamp2)
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE)
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
vals1-vals2
mean(vals1-vals2)
sd(vals1-vals2)
help("t.test")
t.test(x=vals1, y=vals2)
xx = mvtnorm::rmvnorm(myn*100, mean=mymu, sigma=mysig)
xe = xx
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
autoplot(stamp2)
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE);
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
vals1-vals2
vals1 = T4Gauss::dmvnorm(xe, mean=mymu, sigma=mysig, log=FALSE);
vals2 = mvtnorm::dmvnorm(xe, mean=mymu, sigma=mysig, log=FALSE)
t.test(x=vals1, y=vals2)
hist(vals1-vals2)
hist(abs(vals1-vals2))
library(T4Gauss)
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
autoplot(stamp2)
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE)
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
(vals1-vals2)[1:10]
library(T4Gauss)
library(T4Gauss)
stamp2 <- microbenchmark(
vals1 = T4Gauss::dmvnorm(xe, sigma=mysig, log=FALSE),
vals2 = mvtnorm::dmvnorm(xe, sigma=mysig, log=FALSE)
)
autoplot(stamp2)
library(T4Gauss)
library(T4Gauss)
??interpolate
